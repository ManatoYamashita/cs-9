# Computer Simulation 9

``` zsh
2025/07/10
g2172117 山下マナト
```

このプロジェクトは東京都市大学 メディア情報学部 情報システム学科のコンピュータシミュレーションの第9回の課題です。

## 1. ニューラルネットワークによる分類（breast-cancer.arff）

breast-cancer.arffデータセットを用いて、ニューラルネットワークのパラメータを調整し、分類精度を最適化しました。

### 実験結果（上位5件）

| 順位 | 学習率 | 慣性項 | 訓練時間 | 隠れ層 | 精度(%) | 正解数/全体数 |
|------|--------|--------|----------|--------|---------|---------------|
| 1    | 0.3    | 0.5    | 200      | 10     | 69.58   | 199/286       |
| 2    | 0.2    | 0.6    | 150      | 10,5   | 69.58   | 199/286       |
| 3    | 0.1    | 0.2    | 100      | a      | 69.23   | 198/286       |
| 4    | 0.4    | 0.3    | 250      | 15,10  | 69.23   | 198/286       |
| 5    | 0.2    | 0.6    | 150      | 10,5   | 67.83   | 194/286       |

### 混同行列（最高精度のモデル）

```
=== Confusion Matrix ===

   a   b   <-- classified as
 166  35 |   a = no-recurrence-events
  52  33 |   b = recurrence-events
```

### 考察
- 隠れ層の構成は10ノード単層が最も良い性能を示しました
- 学習率は0.2〜0.3の範囲で良好な結果が得られました
- 訓練時間は150〜250エポックが適切でした

## 2. ニューラルネットワークによる回帰（housing.arff）

housing.arffデータセットを用いて、住宅価格の予測精度を最適化しました。

### 実験結果（上位5件：RMSEの小さい順）

| 順位 | 学習率 | 慣性項 | 訓練時間 | 隠れ層 | RMSE    | MAE     | 相関係数 |
|------|--------|--------|----------|--------|---------|---------|----------|
| 1    | 0.05   | 0.5    | 300      | 10     | 3.8804  | 2.5656  | 0.9086   |
| 2    | 0.10   | 0.2    | 200      | a      | 4.0412  | 2.5633  | 0.9006   |
| 3    | 0.20   | 0.3    | 400      | 20     | 4.1494  | 2.7525  | 0.8963   |
| 4    | 0.15   | 0.6    | 250      | 15,10  | 4.1935  | 2.7544  | 0.8967   |
| 5    | 0.30   | 0.4    | 350      | 10,5   | 4.7727  | 3.1776  | 0.8733   |

### 考察
- 低い学習率（0.05）で最良の結果が得られました
- 隠れ層は10ノードの単層構成が効果的でした
- 相関係数は0.9を超え、良好な予測性能を示しています

## 3. ランダムフォレストによる分類（breast-cancer.arff）

木の本数を変化させて、分類精度への影響を調査しました。

### 実験結果

| 木の本数 | 精度(%) | 正解数/全体数 |
|----------|---------|---------------|
| 1        | 63.99   | 183/286       |
| 5        | 67.48   | 193/286       |
| 10       | 69.58   | 199/286       |
| 50       | 68.88   | 197/286       |
| 100      | 69.58   | 199/286       |
| 500      | 69.93   | 200/286       |

### グラフ（グラフを作成）

<img width="549" alt="graph-breast-cancer" src="https://github.com/user-attachments/assets/ec708915-9a47-4ecb-bc73-170cca16f0e8" />

### 考察
- 木の本数が1から10まで増加すると精度が大幅に向上しました
- 10本以降は精度の向上が緩やかになり、収束傾向を示しています
- 500本で最高精度69.93%を達成しましたが、10本でも69.58%と十分な精度が得られました

## 4. ランダムフォレストによる回帰（housing.arff）

シード値を-1（ランダム）に設定し、木の本数の変化による影響を調査しました。

### 実験結果

| 木の本数 | RMSE    | MAE     | 相関係数 |
|----------|---------|---------|----------|
| 1        | 5.3234  | 3.3692  | 0.8342   |
| 5        | 3.7605  | 2.4969  | 0.9127   |
| 10       | 3.4815  | 2.3115  | 0.9269   |
| 50       | 3.3125  | 2.1998  | 0.9364   |
| 100      | 3.2861  | 2.1853  | 0.9376   |
| 500      | 3.2608  | 2.1555  | 0.9384   |

### グラフ（グラフを作成）

<img width="544" alt="graph-housing" src="https://github.com/user-attachments/assets/c49e5c9b-abf1-4704-a378-0d0f693d5aae" />

### 最高精度モデル（木の本数：500）の特徴量説明

| 属性番号 | 属性名 | 説明 |
|----------|--------|------|
| 1 | CRIM | 犯罪率 |
| 2 | ZN | 住宅地の割合 |
| 3 | INDUS | 非小売業の割合 |
| 4 | CHAS | チャールズ川沿い（0/1） |
| 5 | NOX | 窒素酸化物濃度 |
| 6 | RM | 平均部屋数 |
| 7 | AGE | 築年数 |
| 8 | DIS | 雇用中心地までの距離 |
| 9 | RAD | 高速道路へのアクセス |
| 10 | TAX | 固定資産税率 |
| 11 | PTRATIO | 生徒教師比率 |
| 12 | B | 黒人居住者の割合 |
| 13 | LSTAT | 低所得者の割合 |

### 考察
1. **木の本数とRMSEの関係**：木の本数が増加するにつれてRMSEは減少し、精度が向上しました。特に1本から10本への増加で大幅な改善が見られ、50本以降は改善が緩やかになりました。

2. **重要な特徴量**：一般的に住宅価格予測では、平均部屋数（RM）、低所得者の割合（LSTAT）、生徒教師比率（PTRATIO）などが重要な要因となることが知られています。

3. **モデルの性能**：最終的に相関係数0.9384という高い値を達成し、優れた予測性能を示しました。ランダムフォレストは過学習を抑制しながら高い予測精度を実現できることが確認されました。

## 総括

本実験を通じて、機械学習アルゴリズムのパラメータ調整の重要性と、アンサンブル学習（ランダムフォレスト）の有効性を確認できました。特に、ランダムフォレストでは木の本数を増やすことで精度が向上しますが、計算コストとのトレードオフを考慮する必要があることが分かりました。
